!function(){"use strict";const e={inputSelector:".modal__form-input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__form-input-error",errorClass:"modal__form-input-error_active"};class t{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._form=t,this._inputEls=[...this._form.querySelectorAll(this._inputSelector)],this._submitButton=this._form.querySelector(this._submitButtonSelector)}_showInputError(e){const t=this._form.querySelector(`.${e.id}-error`);t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e,t){const s=this._form.querySelector(`.${e.id}-error`);s.textContent="",s.classList.remove(this._errorClass)}_checkInputValidity(e){if(!e.validity.valid)return this._showInputError(e);this._hideInputError(e)}_hasInvalidInput(){return!this._inputEls.every((e=>e.validity.valid))}_toggleButtonState(){this._hasInvalidInput()?this.disableSubmitButton():this.enableSubmitButton()}_setEventListeners(){this._inputEls.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}enableSubmitButton(){this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}disableSubmitButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}resetValidation(){this._toggleButtonState(),this._inputEls.forEach((e=>{this._hideInputError(e)}))}enableValidation(){this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}class s{constructor(e,t,s){let{name:n,link:r}=e;this._name=n,this._link=r,this._cardSelector=t,this._handleImageClick=s;const i=document.querySelector(this._cardSelector).content.querySelector(".card");this._cardElement=i.cloneNode(!0),this._heartButton=this._cardElement.querySelector(".card__heart-button"),this._deleteButton=this._cardElement.querySelector(".card__delete-button"),this._cardImage=this._cardElement.querySelector(".card__image"),this._cardTitle=this._cardElement.querySelector(".card__title")}_handleLikeIcons(){this._heartButton.classList.toggle("card__heart-button-active")}_handleDeleteButton(){}_setEventListeners(){this._heartButton.addEventListener("click",(()=>{this._handleLikeIcons()})),this._deleteButton.addEventListener("click",(()=>{this._handleDeleteButton()})),this._cardImage.addEventListener("click",(()=>{this._handleImageClick({name:this._name,link:this._link})}))}getView(){return this._cardTitle.textContent=this._name,this._cardImage.src=this._link,this._cardImage.alt=this._name,this._setEventListeners(),this._cardElement}}class n{constructor(e){this._modalElement=document.querySelector(e),this._closeButton=this._modalElement.querySelector(".modal__close"),this._handleEscClose=this._handleEscClose.bind(this)}open(){this._modalElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._modalElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(e){"Escape"===e.key&&this.close()}setEventListeners(){this._closeButton.addEventListener("click",(()=>{this.close()})),this._modalElement.addEventListener("click",(e=>{e.target===e.currentTarget&&this.close()}))}}class r extends n{constructor(e,t){super(e),this._modalForm=this._modalElement.querySelector(".modal__form"),this._handleFormSubmit=t,this._inputList=this._modalForm.querySelectorAll(".modal__form-input")}_getInputValues(){return this._inputData={},this._inputList.forEach((e=>{this._inputData[e.name]=e.value})),this._inputData}setEventListeners(){this._modalForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())})),super.setEventListeners()}}document.querySelector(".cards__list");const i=document.querySelector("#profile-modal"),a=document.forms["edit-profile-form"],o=document.querySelector("#add-card-modal"),l=document.forms["add-card-form"],c=document.forms["avatar-form"],d=(document.querySelector("#avatar-modal"),document.querySelector(".profile__add-button")),h=(o.querySelector(".modal__button"),document.querySelector(".profile__edit-button")),u=i.querySelector(".modal__button"),_=c.querySelector(".modal__button"),m=document.querySelector(".profile__avatar"),p=document.querySelector(".profile__title"),E=document.querySelector(".profile__description"),f=document.querySelector(".profile__avatar"),v=i.querySelector("#profile-title-input"),b=i.querySelector("#profile-description-input"),S=new class{constructor(e){this._baseUrl=e.baseUrl,this._headers=e.headers}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then(this._checkResponse).then((e=>e))}editUserInfo(e,t){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e,about:t})}).then(this._checkResponse).then((e=>e))}editUserAvatar(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then(this._checkResponse).then((e=>e))}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(this._checkResponse).then((e=>e))}addNewCard(e){return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:e.title,link:e.link})}).then(this._checkResponse).then((e=>e))}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._checkResponse).then((e=>e))}likeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this._headers}).then(this._checkResponse).then((e=>e))}dislikeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this._headers}).then(this._checkResponse).then((e=>e))}getInitialData(){return Promise.all([this.getUserInfo(),this.getInitialCards()])}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"71ef8ca1-b8c8-47e5-8d73-d71542ab18e9","Content-Type":"application/json"}}),g=new class{constructor(e,t){let{items:s,renderer:n}=e;this._items=s,this._renderer=n,this._container=document.querySelector(t)}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}({items:[{name:"Yosemite Valley",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/yosemite.jpg"},{name:"Lake Louise",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lake-louise.jpg"},{name:"Bald Mountains",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/bald-mountains.jpg"},{name:"Latemar",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/latemar.jpg"},{name:"Vanoise National Park",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/vanoise.jpg"},{name:"Lago di Braies",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lago.jpg"}],renderer:k},".cards__list");function k(e){const t=new s(e,"#card-template",y).getView();g.addItem(t)}function y(e){q.open(e)}function L(){return S.getUserInfo().then((e=>{C.setUserInfo(e.name,e.about,e.avatar)}))}g.renderItems(),L();const C=new class{constructor(e,t,s){this._titleElement=e,this._descriptionElement=t,this._avatarElement=s}getUserInfo(){return{title:this._titleElement.textContent,description:this._descriptionElement.textContent}}setUserInfo(e,t,s){this._avatarElement.src=s,this._titleElement.textContent=e,this._descriptionElement.textContent=t}}(p,E,f);m.addEventListener("click",(()=>{x.open()})),h.addEventListener("click",(()=>{const e=C.getUserInfo();v.value=e.title,b.value=e.description,w.resetValidation(),j.open()})),d.addEventListener("click",(()=>{U.open()}));const I=new t(e,l),w=new t(e,a),B=new t(e,c);I.enableValidation(),w.enableValidation(),B.enableValidation();const q=new class extends n{constructor(e){super(e),this._imageEl=this._modalElement.querySelector(".modal__image"),this._titleEl=this._modalElement.querySelector(".modal__image-title")}open(e){this._imageEl.src=e.link,this._imageEl.alt=e.name,this._titleEl.textContent=e.name,super.open()}}("#image-modal");q.setEventListeners();const U=new r("#add-card-modal",(function(e){k({name:e.title,link:e["Image URL"]}),U.close(),l.reset(),I.disableSubmitButton()}));U.setEventListeners();const j=new r("#profile-modal",(function(e){u.textContent="Saving...";const t=e.title,s=e.description;S.editUserInfo(t,s).then((()=>{L(),j.close(),u.textContent="Save"}))}));j.setEventListeners(),new r("#delete-card-modal").setEventListeners();const x=new r("#avatar-modal",(function(e){_.textContent="Saving...";const t=e["avatar URL"];S.editUserAvatar(t),setTimeout((()=>{L(),x.close(),_.textContent="Save"}),1e3)}));x.setEventListeners()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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aEYsS0FBTWlJLEVBQVUsZUFJbEJMLEVBQWFqRyxRQUNib0IsRUFBWW1GLFFBQ1pMLEVBQXFCNUkscUJBQ3ZCLElBa0ZBMkksRUFBYTlGLG9CQUliLE1BQU02RixFQUFlLElBQUkxRixFQUN2QixrQkFyRkYsU0FBaUN3RixHQUMvQnRFLEVBQWtCL0UsWUFBYyxZQUNoQyxNQUFNNEcsRUFBUXlDLEVBQVN6QyxNQUNqQnVDLEVBQWNFLEVBQVNGLFlBQzdCNUQsRUFBSVUsYUFBYVcsRUFBT3VDLEdBQWFyRCxNQUFLLEtBQ3hDMkMsSUFDQWMsRUFBYWhHLFFBQ2J3QixFQUFrQi9FLFlBQWMsTUFBTSxHQUUxQyxJQWdGQXVKLEVBQWE3RixvQkFJTyxJQUFJRyxFQUN0QixzQkFJVUgsb0JBSVosTUFBTTBGLEVBQWMsSUFBSXZGLEVBQWMsaUJBM0Z0QyxTQUFnQ2tHLEdBQzlCL0UsRUFBaUJoRixZQUFjLFlBQy9CLE1BQU13RyxFQUFTdUQsRUFBVyxjQUMxQnhFLEVBQUlnQixlQUFlQyxHQUNuQndELFlBQVcsS0FDVHZCLElBQ0FXLEVBQVk3RixRQUNaeUIsRUFBaUJoRixZQUFjLE1BQU0sR0FDcEMsSUFDTCxJQW9GQW9KLEVBQVkxRixtQiIsInNvdXJjZXMiOlsid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY29uc3QgaW5pdGlhbENhcmRzID0gW1xyXG4gIHtcclxuICAgIG5hbWU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QveW9zZW1pdGUuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkxha2UgTG91aXNlXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGFrZS1sb3Vpc2UuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkJhbGQgTW91bnRhaW5zXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvYmFsZC1tb3VudGFpbnMuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkxhdGVtYXJcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYXRlbWFyLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJWYW5vaXNlIE5hdGlvbmFsIFBhcmtcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC92YW5vaXNlLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYWdvIGRpIEJyYWllc1wiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhZ28uanBnXCIsXHJcbiAgfSxcclxuXTtcclxuXHJcbmV4cG9ydCBjb25zdCB2YWxpZGF0aW9uU2V0dGluZ3MgPSB7XHJcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2Zvcm0taW5wdXRcIixcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX2J1dHRvblwiLFxyXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX2J1dHRvbl9kaXNhYmxlZFwiLFxyXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9fZm9ybS1pbnB1dC1lcnJvclwiLFxyXG4gIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Zvcm0taW5wdXQtZXJyb3JfYWN0aXZlXCIsXHJcbn07XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xyXG4gIGNvbnN0cnVjdG9yKHNldHRpbmdzLCBmb3JtRWxlbWVudCkge1xyXG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IHNldHRpbmdzLmlucHV0U2VsZWN0b3I7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IHNldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xyXG4gICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IHNldHRpbmdzLmluYWN0aXZlQnV0dG9uQ2xhc3M7XHJcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBzZXR0aW5ncy5pbnB1dEVycm9yQ2xhc3M7XHJcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gc2V0dGluZ3MuZXJyb3JDbGFzcztcclxuXHJcbiAgICB0aGlzLl9mb3JtID0gZm9ybUVsZW1lbnQ7XHJcblxyXG4gICAgdGhpcy5faW5wdXRFbHMgPSBbLi4udGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpXTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3Rvcih0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbCkge1xyXG4gICAgY29uc3QgZXJyb3JNZXNzYWdlRWwgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYC4ke2lucHV0RWwuaWR9LWVycm9yYCk7XHJcbiAgICBlcnJvck1lc3NhZ2VFbC50ZXh0Q29udGVudCA9IGlucHV0RWwudmFsaWRhdGlvbk1lc3NhZ2U7XHJcbiAgICBlcnJvck1lc3NhZ2VFbC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gIH1cclxuXHJcbiAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWwsIG9wdGlvbnMpIHtcclxuICAgIGNvbnN0IGVycm9yTWVzc2FnZUVsID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dEVsLmlkfS1lcnJvcmApO1xyXG4gICAgZXJyb3JNZXNzYWdlRWwudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gICAgZXJyb3JNZXNzYWdlRWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcclxuICB9XHJcblxyXG4gIF9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbCkge1xyXG4gICAgaWYgKCFpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsKTtcclxuICAgIH1cclxuICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWwpO1xyXG4gIH1cclxuXHJcbiAgX2hhc0ludmFsaWRJbnB1dCgpIHtcclxuICAgIHJldHVybiAhdGhpcy5faW5wdXRFbHMuZXZlcnkoKGlucHV0RWwpID0+IGlucHV0RWwudmFsaWRpdHkudmFsaWQpO1xyXG4gIH1cclxuXHJcbiAgX3RvZ2dsZUJ1dHRvblN0YXRlKCkge1xyXG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCgpKSB7XHJcbiAgICAgIHRoaXMuZGlzYWJsZVN1Ym1pdEJ1dHRvbigpO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICB0aGlzLmVuYWJsZVN1Ym1pdEJ1dHRvbigpO1xyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5faW5wdXRFbHMuZm9yRWFjaCgoaW5wdXRFbCkgPT4ge1xyXG4gICAgICBpbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWwpO1xyXG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBlbmFibGVTdWJtaXRCdXR0b24oKSB7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gIH1cclxuXHJcbiAgZGlzYWJsZVN1Ym1pdEJ1dHRvbigpIHtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcclxuICB9XHJcblxyXG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcblxyXG4gICAgdGhpcy5faW5wdXRFbHMuZm9yRWFjaCgoaW5wdXRFbCkgPT4ge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XHJcbiAgY29uc3RydWN0b3IoeyBuYW1lLCBsaW5rIH0sIGNhcmRTZWxlY3RvciwgaGFuZGxlSW1hZ2VDbGljaykge1xyXG4gICAgdGhpcy5fbmFtZSA9IG5hbWU7XHJcbiAgICB0aGlzLl9saW5rID0gbGluaztcclxuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcclxuICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sgPSBoYW5kbGVJbWFnZUNsaWNrO1xyXG4gICAgY29uc3QgY2FyZFRlbXBsYXRlID0gZG9jdW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKVxyXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIik7XHJcblxyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSBjYXJkVGVtcGxhdGUuY2xvbmVOb2RlKHRydWUpO1xyXG4gICAgdGhpcy5faGVhcnRCdXR0b24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2hlYXJ0LWJ1dHRvblwiKTtcclxuICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIFwiLmNhcmRfX2RlbGV0ZS1idXR0b25cIlxyXG4gICAgKTtcclxuICAgIHRoaXMuX2NhcmRJbWFnZSA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XHJcbiAgICB0aGlzLl9jYXJkVGl0bGUgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RpdGxlXCIpO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZUxpa2VJY29ucygpIHtcclxuICAgIHRoaXMuX2hlYXJ0QnV0dG9uLmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkX19oZWFydC1idXR0b24tYWN0aXZlXCIpO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZURlbGV0ZUJ1dHRvbigpIHt9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2hlYXJ0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUxpa2VJY29ucygpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUJ1dHRvbigpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5fY2FyZEltYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2soeyBuYW1lOiB0aGlzLl9uYW1lLCBsaW5rOiB0aGlzLl9saW5rIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBnZXRWaWV3KCkge1xyXG4gICAgdGhpcy5fY2FyZFRpdGxlLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcclxuICAgIHRoaXMuX2NhcmRJbWFnZS5zcmMgPSB0aGlzLl9saW5rO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlLmFsdCA9IHRoaXMuX25hbWU7XHJcblxyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbiAgICByZXR1cm4gdGhpcy5fY2FyZEVsZW1lbnQ7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9tb2RhbEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fY2xvc2VCdXR0b24gPSB0aGlzLl9tb2RhbEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2VcIik7XHJcbiAgICB0aGlzLl9oYW5kbGVFc2NDbG9zZSA9IHRoaXMuX2hhbmRsZUVzY0Nsb3NlLmJpbmQodGhpcyk7XHJcbiAgfVxyXG5cclxuICBvcGVuKCkge1xyXG4gICAgLy8gb3BlbiBwb3B1cFxyXG4gICAgdGhpcy5fbW9kYWxFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgfVxyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIC8vIGNsb3NlIHBvcHVwXHJcbiAgICB0aGlzLl9tb2RhbEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcclxuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVFc2NDbG9zZShldnQpIHtcclxuICAgIC8vIGxpc3RlbnMgZm9yIGVzYyBidXR0b25cclxuICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgLy8gc2V0cyBldmVudCBsaXN0ZW5lcnNcclxuICAgIHRoaXMuX2Nsb3NlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHRoaXMuX21vZGFsRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBpZiAoZXZ0LnRhcmdldCA9PT0gZXZ0LmN1cnJlbnRUYXJnZXQpIHtcclxuICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCkge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9tb2RhbEZvcm0gPSB0aGlzLl9tb2RhbEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xyXG4gICAgdGhpcy5faW5wdXRMaXN0ID0gdGhpcy5fbW9kYWxGb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2Zvcm0taW5wdXRcIik7XHJcbiAgfVxyXG5cclxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XHJcbiAgICB0aGlzLl9pbnB1dERhdGEgPSB7fTtcclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICB0aGlzLl9pbnB1dERhdGFbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHRoaXMuX2lucHV0RGF0YTtcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgLy8gYWRkIGEgc3VibWl0IGV2ZW50IGxpc3RlbmVyIHRvIHRoZSBmb3JtXHJcbiAgICB0aGlzLl9tb2RhbEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xyXG4gICAgfSk7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH1cclxufVxyXG4iLCIvLyBUT0tFTiA6IFwiNzFlZjhjYTEtYjhjOC00N2U1LThkNzMtZDcxNTQyYWIxOGU5XCJcclxuXHJcbmltcG9ydCBcIi4uL3BhZ2VzL2luZGV4LmNzc1wiO1xyXG5cclxuaW1wb3J0IHsgaW5pdGlhbENhcmRzLCB2YWxpZGF0aW9uU2V0dGluZ3MgfSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XHJcblxyXG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XHJcblxyXG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XHJcblxyXG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcclxuXHJcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcclxuXHJcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xyXG5cclxuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xyXG5cclxuaW1wb3J0IEFwaSBmcm9tIFwiLi4vY29tcG9uZW50cy9BcGkuanNcIjtcclxuXHJcbi8vIENvbnRhaW5lcnNcclxuXHJcbmNvbnN0IGNhcmRMaXN0RWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19saXN0XCIpO1xyXG5jb25zdCBlZGl0UHJvZmlsZU1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLW1vZGFsXCIpO1xyXG5jb25zdCBlZGl0UHJvZmlsZUZvcm0gPSBkb2N1bWVudC5mb3Jtc1tcImVkaXQtcHJvZmlsZS1mb3JtXCJdO1xyXG5jb25zdCBhZGRDYXJkTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1jYXJkLW1vZGFsXCIpO1xyXG5jb25zdCBhZGRDYXJkRm9ybSA9IGRvY3VtZW50LmZvcm1zW1wiYWRkLWNhcmQtZm9ybVwiXTtcclxuY29uc3QgYXZhdGFyRm9ybSA9IGRvY3VtZW50LmZvcm1zW1wiYXZhdGFyLWZvcm1cIl07XHJcbmNvbnN0IGVkaXRBdmF0YXJNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYXZhdGFyLW1vZGFsXCIpO1xyXG5cclxuLy8gQnV0dG9uc1xyXG5cclxuY29uc3QgYWRkQ2FyZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ1dHRvblwiKTtcclxuY29uc3QgYWRkQ2FyZFNhdmVCdXR0b24gPSBhZGRDYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fYnV0dG9uXCIpO1xyXG5jb25zdCBwcm9maWxlRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZWRpdC1idXR0b25cIik7XHJcbmNvbnN0IHByb2ZpbGVTYXZlQnV0dG9uID0gZWRpdFByb2ZpbGVNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b25cIik7XHJcbmNvbnN0IGF2YXRhclNhdmVCdXR0b24gPSBhdmF0YXJGb3JtLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2J1dHRvblwiKTtcclxuY29uc3QgZWRpdEF2YXRhckJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYXZhdGFyXCIpO1xyXG5cclxuLy8gTWlzY1xyXG5cclxuY29uc3QgcHJvZmlsZVRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX190aXRsZVwiKTtcclxuY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiKTtcclxuY29uc3QgcHJvZmlsZUF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYXZhdGFyXCIpO1xyXG5cclxuLy8gSW5wdXRzXHJcblxyXG5jb25zdCBuYW1lSW5wdXQgPSBlZGl0UHJvZmlsZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS10aXRsZS1pbnB1dFwiKTtcclxuY29uc3QgZGVzY3JpcHRpb25JbnB1dCA9IGVkaXRQcm9maWxlTW9kYWwucXVlcnlTZWxlY3RvcihcclxuICBcIiNwcm9maWxlLWRlc2NyaXB0aW9uLWlucHV0XCJcclxuKTtcclxuXHJcbi8vIEFwaVxyXG5cclxuY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxyXG4gIGhlYWRlcnM6IHtcclxuICAgIGF1dGhvcml6YXRpb246IFwiNzFlZjhjYTEtYjhjOC00N2U1LThkNzMtZDcxNTQyYWIxOGU5XCIsXHJcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICB9LFxyXG59KTtcclxuXHJcbi8vIENhcmRzXHJcblxyXG5jb25zdCBzZWN0aW9uID0gbmV3IFNlY3Rpb24oXHJcbiAge1xyXG4gICAgaXRlbXM6IGluaXRpYWxDYXJkcyxcclxuICAgIHJlbmRlcmVyOiBjcmVhdGVDYXJkLFxyXG4gIH0sXHJcbiAgXCIuY2FyZHNfX2xpc3RcIlxyXG4pO1xyXG5cclxuc2VjdGlvbi5yZW5kZXJJdGVtcygpO1xyXG5cclxuLy8gRXZlbnQgSGFuZGxlcnNcclxuXHJcbmZ1bmN0aW9uIGNyZWF0ZUNhcmQoZGF0YSkge1xyXG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gZ2V0Q2FyZEVsZW1lbnQoZGF0YSk7XHJcbiAgc2VjdGlvbi5hZGRJdGVtKGNhcmRFbGVtZW50KTtcclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0Q2FyZEVsZW1lbnQoY2FyZERhdGEpIHtcclxuICBjb25zdCBjYXJkID0gbmV3IENhcmQoY2FyZERhdGEsIFwiI2NhcmQtdGVtcGxhdGVcIiwgaGFuZGxlSW1hZ2VDbGljayk7XHJcbiAgcmV0dXJuIGNhcmQuZ2V0VmlldygpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVJbWFnZUNsaWNrKGNhcmREYXRhKSB7XHJcbiAgaW1hZ2VNb2RhbC5vcGVuKGNhcmREYXRhKTtcclxufVxyXG5cclxuLy8gZnVuY3Rpb24gaGFuZGxlRGVsZXRlQ2FyZFN1Ym1pdChjYXJkRGF0YSkge31cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUFkZENhcmRGb3JtU3VibWl0KGlucHV0RGF0YSkge1xyXG4gIGNvbnN0IGNhcmREYXRhID0ge1xyXG4gICAgbmFtZTogaW5wdXREYXRhLnRpdGxlLFxyXG4gICAgbGluazogaW5wdXREYXRhW1wiSW1hZ2UgVVJMXCJdLFxyXG4gIH07XHJcblxyXG4gIGNyZWF0ZUNhcmQoY2FyZERhdGEpO1xyXG4gIG5ld0NhcmRNb2RhbC5jbG9zZSgpO1xyXG4gIGFkZENhcmRGb3JtLnJlc2V0KCk7XHJcbiAgYWRkQ2FyZEZvcm1WYWxpZGF0b3IuZGlzYWJsZVN1Ym1pdEJ1dHRvbigpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVQcm9maWxlRm9ybVN1Ym1pdCh1c2VyRGF0YSkge1xyXG4gIHByb2ZpbGVTYXZlQnV0dG9uLnRleHRDb250ZW50ID0gXCJTYXZpbmcuLi5cIjtcclxuICBjb25zdCB0aXRsZSA9IHVzZXJEYXRhLnRpdGxlO1xyXG4gIGNvbnN0IGRlc2NyaXB0aW9uID0gdXNlckRhdGEuZGVzY3JpcHRpb247XHJcbiAgYXBpLmVkaXRVc2VySW5mbyh0aXRsZSwgZGVzY3JpcHRpb24pLnRoZW4oKCkgPT4ge1xyXG4gICAgZ2V0UHJvZmlsZURhdGEoKTtcclxuICAgIHByb2ZpbGVNb2RhbC5jbG9zZSgpO1xyXG4gICAgcHJvZmlsZVNhdmVCdXR0b24udGV4dENvbnRlbnQgPSBcIlNhdmVcIjtcclxuICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlQXZhdGFyRm9ybVN1Ym1pdChhdmF0YXJEYXRhKSB7XHJcbiAgYXZhdGFyU2F2ZUJ1dHRvbi50ZXh0Q29udGVudCA9IFwiU2F2aW5nLi4uXCI7XHJcbiAgY29uc3QgYXZhdGFyID0gYXZhdGFyRGF0YVtcImF2YXRhciBVUkxcIl07XHJcbiAgYXBpLmVkaXRVc2VyQXZhdGFyKGF2YXRhcik7XHJcbiAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICBnZXRQcm9maWxlRGF0YSgpO1xyXG4gICAgYXZhdGFyTW9kYWwuY2xvc2UoKTtcclxuICAgIGF2YXRhclNhdmVCdXR0b24udGV4dENvbnRlbnQgPSBcIlNhdmVcIjtcclxuICB9LCAxMDAwKTtcclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0UHJvZmlsZURhdGEoKSB7XHJcbiAgcmV0dXJuIGFwaS5nZXRVc2VySW5mbygpLnRoZW4oKHByb2ZpbGVEYXRhKSA9PiB7XHJcbiAgICB1c2VySW5mby5zZXRVc2VySW5mbyhcclxuICAgICAgcHJvZmlsZURhdGFbXCJuYW1lXCJdLFxyXG4gICAgICBwcm9maWxlRGF0YVtcImFib3V0XCJdLFxyXG4gICAgICBwcm9maWxlRGF0YVtcImF2YXRhclwiXVxyXG4gICAgKTtcclxuICB9KTtcclxufVxyXG5cclxuZ2V0UHJvZmlsZURhdGEoKTtcclxuXHJcbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHByb2ZpbGVUaXRsZSwgcHJvZmlsZURlc2NyaXB0aW9uLCBwcm9maWxlQXZhdGFyKTtcclxuXHJcbi8vIEV2ZW50IExpc3RlbmVyc1xyXG5cclxuZWRpdEF2YXRhckJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGF2YXRhck1vZGFsLm9wZW4oKTtcclxufSk7XHJcblxyXG5wcm9maWxlRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGNvbnN0IHVzZXJEYXRhID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcclxuICBuYW1lSW5wdXQudmFsdWUgPSB1c2VyRGF0YS50aXRsZTtcclxuICBkZXNjcmlwdGlvbklucHV0LnZhbHVlID0gdXNlckRhdGEuZGVzY3JpcHRpb247XHJcbiAgcHJvZmlsZUZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgcHJvZmlsZU1vZGFsLm9wZW4oKTtcclxufSk7XHJcblxyXG5hZGRDYXJkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgbmV3Q2FyZE1vZGFsLm9wZW4oKTtcclxufSk7XHJcblxyXG4vLyBWYWxpZGF0aW9uXHJcblxyXG5jb25zdCBhZGRDYXJkRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHZhbGlkYXRpb25TZXR0aW5ncywgYWRkQ2FyZEZvcm0pO1xyXG5jb25zdCBwcm9maWxlRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKFxyXG4gIHZhbGlkYXRpb25TZXR0aW5ncyxcclxuICBlZGl0UHJvZmlsZUZvcm1cclxuKTtcclxuY29uc3QgYXZhdGFyRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHZhbGlkYXRpb25TZXR0aW5ncywgYXZhdGFyRm9ybSk7XHJcblxyXG5hZGRDYXJkRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbnByb2ZpbGVGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuYXZhdGFyRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcblxyXG4vLyBJbWFnZSBNb2RhbFxyXG5cclxuY29uc3QgaW1hZ2VNb2RhbCA9IG5ldyBQb3B1cFdpdGhJbWFnZShcIiNpbWFnZS1tb2RhbFwiKTtcclxuXHJcbmltYWdlTW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbi8vIEFkZCBDYXJkIE1vZGFsXHJcblxyXG5jb25zdCBuZXdDYXJkTW9kYWwgPSBuZXcgUG9wdXBXaXRoRm9ybShcclxuICBcIiNhZGQtY2FyZC1tb2RhbFwiLFxyXG4gIGhhbmRsZUFkZENhcmRGb3JtU3VibWl0XHJcbik7XHJcblxyXG5uZXdDYXJkTW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbi8vIFByb2ZpbGUgTW9kYWxcclxuXHJcbmNvbnN0IHByb2ZpbGVNb2RhbCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxyXG4gIFwiI3Byb2ZpbGUtbW9kYWxcIixcclxuICBoYW5kbGVQcm9maWxlRm9ybVN1Ym1pdFxyXG4pO1xyXG5cclxucHJvZmlsZU1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4vLyBEZWxldGUgQ2FyZCBNb2RhbFxyXG5cclxuY29uc3QgZGVsZXRlTW9kYWwgPSBuZXcgUG9wdXBXaXRoRm9ybShcclxuICBcIiNkZWxldGUtY2FyZC1tb2RhbFwiXHJcbiAgLy8gaGFuZGxlRGVsZXRlQ2FyZFN1Ym1pdFxyXG4pO1xyXG5cclxuZGVsZXRlTW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbi8vIEF2YXRhciBNb2RhbFxyXG5cclxuY29uc3QgYXZhdGFyTW9kYWwgPSBuZXcgUG9wdXBXaXRoRm9ybShcIiNhdmF0YXItbW9kYWxcIiwgaGFuZGxlQXZhdGFyRm9ybVN1Ym1pdCk7XHJcblxyXG5hdmF0YXJNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xyXG4iLCIvLyBUT0tFTiA6IFwiNzFlZjhjYTEtYjhjOC00N2U1LThkNzMtZDcxNTQyYWIxOGU5XCJcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XHJcbiAgY29uc3RydWN0b3Iob3B0aW9ucykge1xyXG4gICAgdGhpcy5fYmFzZVVybCA9IG9wdGlvbnMuYmFzZVVybDtcclxuICAgIHRoaXMuX2hlYWRlcnMgPSBvcHRpb25zLmhlYWRlcnM7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pXHJcbiAgICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpXHJcbiAgICAgIC50aGVuKChyZXMpID0+IHJlcyk7XHJcbiAgfVxyXG5cclxuICBlZGl0VXNlckluZm8obmFtZSwgYWJvdXQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lOiBuYW1lLFxyXG4gICAgICAgIGFib3V0OiBhYm91dCxcclxuICAgICAgfSksXHJcbiAgICB9KVxyXG4gICAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKVxyXG4gICAgICAudGhlbigocmVzKSA9PiByZXMpO1xyXG4gIH1cclxuXHJcbiAgZWRpdFVzZXJBdmF0YXIoYXZhdGFyKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIGF2YXRhcjogYXZhdGFyLFxyXG4gICAgICB9KSxcclxuICAgIH0pXHJcbiAgICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpXHJcbiAgICAgIC50aGVuKChyZXMpID0+IHJlcyk7XHJcbiAgfVxyXG5cclxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KVxyXG4gICAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKVxyXG4gICAgICAudGhlbigocmVzKSA9PiByZXMpO1xyXG4gIH1cclxuXHJcbiAgYWRkTmV3Q2FyZChkYXRhKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lOiBkYXRhLnRpdGxlLFxyXG4gICAgICAgIGxpbms6IGRhdGEubGluayxcclxuICAgICAgfSksXHJcbiAgICB9KVxyXG4gICAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKVxyXG4gICAgICAudGhlbigocmVzKSA9PiByZXMpO1xyXG4gIH1cclxuXHJcbiAgZGVsZXRlQ2FyZChjYXJkSWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH1gLCB7XHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pXHJcbiAgICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpXHJcbiAgICAgIC50aGVuKChyZXMpID0+IHJlcyk7XHJcbiAgfVxyXG5cclxuICBsaWtlQ2FyZChjYXJkSWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQVVRcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pXHJcbiAgICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpXHJcbiAgICAgIC50aGVuKChyZXMpID0+IHJlcyk7XHJcbiAgfVxyXG5cclxuICBkaXNsaWtlQ2FyZChjYXJkSWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pXHJcbiAgICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpXHJcbiAgICAgIC50aGVuKChyZXMpID0+IHJlcyk7XHJcbiAgfVxyXG5cclxuICBnZXRJbml0aWFsRGF0YSgpIHtcclxuICAgIHJldHVybiBQcm9taXNlLmFsbChbdGhpcy5nZXRVc2VySW5mbygpLCB0aGlzLmdldEluaXRpYWxDYXJkcygpXSk7XHJcbiAgfVxyXG5cclxuICBfY2hlY2tSZXNwb25zZShyZXMpIHtcclxuICAgIGlmIChyZXMub2spIHtcclxuICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgfVxyXG5cclxuICAvLyBvdGhlciBtZXRob2RzIGZvciB3b3JraW5nIHdpdGggdGhlIEFQSVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xyXG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNsYXNzU2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX2l0ZW1zID0gaXRlbXM7XHJcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xyXG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihjbGFzc1NlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIHJlbmRlckl0ZW1zKCkge1xyXG4gICAgdGhpcy5faXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xyXG4gICAgICB0aGlzLl9yZW5kZXJlcihpdGVtKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgYWRkSXRlbShFbCkge1xyXG4gICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoRWwpO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XHJcbiAgY29uc3RydWN0b3IodGl0bGVFbGVtZW50LCBkZXNjcmlwdGlvbkVsZW1lbnQsIGF2YXRhckVsZW1lbnQpIHtcclxuICAgIC8vXHJcbiAgICB0aGlzLl90aXRsZUVsZW1lbnQgPSB0aXRsZUVsZW1lbnQ7XHJcbiAgICB0aGlzLl9kZXNjcmlwdGlvbkVsZW1lbnQgPSBkZXNjcmlwdGlvbkVsZW1lbnQ7XHJcbiAgICB0aGlzLl9hdmF0YXJFbGVtZW50ID0gYXZhdGFyRWxlbWVudDtcclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgdGl0bGU6IHRoaXMuX3RpdGxlRWxlbWVudC50ZXh0Q29udGVudCxcclxuICAgICAgZGVzY3JpcHRpb246IHRoaXMuX2Rlc2NyaXB0aW9uRWxlbWVudC50ZXh0Q29udGVudCxcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBzZXRVc2VySW5mbyh0aXRsZSwgZGVzY3JpcHRpb24sIGF2YXRhcikge1xyXG4gICAgdGhpcy5fYXZhdGFyRWxlbWVudC5zcmMgPSBhdmF0YXI7XHJcbiAgICB0aGlzLl90aXRsZUVsZW1lbnQudGV4dENvbnRlbnQgPSB0aXRsZTtcclxuICAgIHRoaXMuX2Rlc2NyaXB0aW9uRWxlbWVudC50ZXh0Q29udGVudCA9IGRlc2NyaXB0aW9uO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG5cclxuICAgIHRoaXMuX2ltYWdlRWwgPSB0aGlzLl9tb2RhbEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW1hZ2VcIik7XHJcbiAgICB0aGlzLl90aXRsZUVsID0gdGhpcy5fbW9kYWxFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2ltYWdlLXRpdGxlXCIpO1xyXG4gIH1cclxuXHJcbiAgb3BlbihjYXJkRGF0YSkge1xyXG4gICAgdGhpcy5faW1hZ2VFbC5zcmMgPSBjYXJkRGF0YS5saW5rO1xyXG4gICAgdGhpcy5faW1hZ2VFbC5hbHQgPSBjYXJkRGF0YS5uYW1lO1xyXG4gICAgdGhpcy5fdGl0bGVFbC50ZXh0Q29udGVudCA9IGNhcmREYXRhLm5hbWU7XHJcblxyXG4gICAgc3VwZXIub3BlbigpO1xyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsidmFsaWRhdGlvblNldHRpbmdzIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJGb3JtVmFsaWRhdG9yIiwiY29uc3RydWN0b3IiLCJzZXR0aW5ncyIsImZvcm1FbGVtZW50IiwidGhpcyIsIl9pbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJfZm9ybSIsIl9pbnB1dEVscyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJfc3VibWl0QnV0dG9uIiwicXVlcnlTZWxlY3RvciIsIl9zaG93SW5wdXRFcnJvciIsImlucHV0RWwiLCJlcnJvck1lc3NhZ2VFbCIsImlkIiwidGV4dENvbnRlbnQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsImNsYXNzTGlzdCIsImFkZCIsIl9oaWRlSW5wdXRFcnJvciIsIm9wdGlvbnMiLCJyZW1vdmUiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9oYXNJbnZhbGlkSW5wdXQiLCJldmVyeSIsIl90b2dnbGVCdXR0b25TdGF0ZSIsImRpc2FibGVTdWJtaXRCdXR0b24iLCJlbmFibGVTdWJtaXRCdXR0b24iLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJmb3JFYWNoIiwiYWRkRXZlbnRMaXN0ZW5lciIsImRpc2FibGVkIiwicmVzZXRWYWxpZGF0aW9uIiwiZW5hYmxlVmFsaWRhdGlvbiIsImV2dCIsInByZXZlbnREZWZhdWx0IiwiQ2FyZCIsIl9yZWYiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVJbWFnZUNsaWNrIiwibmFtZSIsImxpbmsiLCJfbmFtZSIsIl9saW5rIiwiX2NhcmRTZWxlY3RvciIsIl9oYW5kbGVJbWFnZUNsaWNrIiwiY2FyZFRlbXBsYXRlIiwiZG9jdW1lbnQiLCJjb250ZW50IiwiX2NhcmRFbGVtZW50IiwiY2xvbmVOb2RlIiwiX2hlYXJ0QnV0dG9uIiwiX2RlbGV0ZUJ1dHRvbiIsIl9jYXJkSW1hZ2UiLCJfY2FyZFRpdGxlIiwiX2hhbmRsZUxpa2VJY29ucyIsInRvZ2dsZSIsIl9oYW5kbGVEZWxldGVCdXR0b24iLCJnZXRWaWV3Iiwic3JjIiwiYWx0IiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX21vZGFsRWxlbWVudCIsIl9jbG9zZUJ1dHRvbiIsIl9oYW5kbGVFc2NDbG9zZSIsImJpbmQiLCJvcGVuIiwiY2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwia2V5Iiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJ0YXJnZXQiLCJjdXJyZW50VGFyZ2V0IiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsIl9tb2RhbEZvcm0iLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9pbnB1dExpc3QiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJfaW5wdXREYXRhIiwiaW5wdXQiLCJ2YWx1ZSIsImVkaXRQcm9maWxlTW9kYWwiLCJlZGl0UHJvZmlsZUZvcm0iLCJmb3JtcyIsImFkZENhcmRNb2RhbCIsImFkZENhcmRGb3JtIiwiYXZhdGFyRm9ybSIsImFkZENhcmRCdXR0b24iLCJwcm9maWxlRWRpdEJ1dHRvbiIsInByb2ZpbGVTYXZlQnV0dG9uIiwiYXZhdGFyU2F2ZUJ1dHRvbiIsImVkaXRBdmF0YXJCdXR0b24iLCJwcm9maWxlVGl0bGUiLCJwcm9maWxlRGVzY3JpcHRpb24iLCJwcm9maWxlQXZhdGFyIiwibmFtZUlucHV0IiwiZGVzY3JpcHRpb25JbnB1dCIsImFwaSIsIl9iYXNlVXJsIiwiYmFzZVVybCIsIl9oZWFkZXJzIiwiaGVhZGVycyIsImdldFVzZXJJbmZvIiwiZmV0Y2giLCJ0aGVuIiwiX2NoZWNrUmVzcG9uc2UiLCJyZXMiLCJlZGl0VXNlckluZm8iLCJhYm91dCIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiZWRpdFVzZXJBdmF0YXIiLCJhdmF0YXIiLCJnZXRJbml0aWFsQ2FyZHMiLCJhZGROZXdDYXJkIiwiZGF0YSIsInRpdGxlIiwiZGVsZXRlQ2FyZCIsImNhcmRJZCIsImxpa2VDYXJkIiwiZGlzbGlrZUNhcmQiLCJnZXRJbml0aWFsRGF0YSIsIlByb21pc2UiLCJhbGwiLCJvayIsImpzb24iLCJyZWplY3QiLCJzdGF0dXMiLCJhdXRob3JpemF0aW9uIiwic2VjdGlvbiIsImNsYXNzU2VsZWN0b3IiLCJpdGVtcyIsInJlbmRlcmVyIiwiX2l0ZW1zIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsInJlbmRlckl0ZW1zIiwiaXRlbSIsImFkZEl0ZW0iLCJFbCIsInByZXBlbmQiLCJjcmVhdGVDYXJkIiwiY2FyZEVsZW1lbnQiLCJjYXJkRGF0YSIsImltYWdlTW9kYWwiLCJnZXRQcm9maWxlRGF0YSIsInByb2ZpbGVEYXRhIiwidXNlckluZm8iLCJzZXRVc2VySW5mbyIsInRpdGxlRWxlbWVudCIsImRlc2NyaXB0aW9uRWxlbWVudCIsImF2YXRhckVsZW1lbnQiLCJfdGl0bGVFbGVtZW50IiwiX2Rlc2NyaXB0aW9uRWxlbWVudCIsIl9hdmF0YXJFbGVtZW50IiwiZGVzY3JpcHRpb24iLCJhdmF0YXJNb2RhbCIsInVzZXJEYXRhIiwicHJvZmlsZUZvcm1WYWxpZGF0b3IiLCJwcm9maWxlTW9kYWwiLCJuZXdDYXJkTW9kYWwiLCJhZGRDYXJkRm9ybVZhbGlkYXRvciIsImF2YXRhckZvcm1WYWxpZGF0b3IiLCJfaW1hZ2VFbCIsIl90aXRsZUVsIiwiaW5wdXREYXRhIiwicmVzZXQiLCJhdmF0YXJEYXRhIiwic2V0VGltZW91dCJdLCJzb3VyY2VSb290IjoiIn0=